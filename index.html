<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>電腦命令提示執行模擬器</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Consolas', 'Courier New', monospace;
        }

        :root {
            --primary-blue: #0078d4;
            --terminal-blue: #00aaff;
            --terminal-black: #0c0c0c;
            --terminal-green: #16c60c;
            --terminal-yellow: #f9f1a5;
            --terminal-red: #e74856;
            --terminal-purple: #b4009e;
            --gray-bg: #1a1a1a;
            --light-gray: #e5e5e5;
            --text-dark: #1a1a1a;
            --text-light: #f2f2f2;
            --glass-effect: rgba(0, 10, 20, 0.9);
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
            --win7-blue: #0d5ca3;
            --win10-blue: #0078d7;
            --win11-purple: #5b2be2;
        }

        body {
            background: linear-gradient(135deg, #0a0a2a, #1a1a3a, #2a2a4a);
            color: var(--text-light);
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* 隱藏所有頁面 */
        .page {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* 主頁樣式 */
        .main-header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: var(--glass-effect);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            border: 1px solid rgba(0, 170, 255, 0.3);
            box-shadow: var(--shadow);
        }

        .main-icon {
            font-size: 4rem;
            color: var(--terminal-blue);
            margin-bottom: 20px;
            filter: drop-shadow(0 0 15px rgba(0, 170, 255, 0.5));
        }

        .main-title {
            font-size: 2.5rem;
            background: linear-gradient(90deg, #00aaff, #0088ff, #9d4edd);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 2px 15px rgba(0, 132, 255, 0.4);
            margin-bottom: 15px;
        }

        .main-subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto 25px;
            line-height: 1.6;
        }

        /* 類別選項 */
        .category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .category-card {
            background: rgba(0, 20, 40, 0.7);
            border-radius: 15px;
            padding: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
            text-align: center;
        }

        .category-card:hover {
            transform: translateY(-10px);
            border-color: var(--terminal-blue);
            box-shadow: 0 15px 30px rgba(0, 170, 255, 0.2);
        }

        .category-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 170, 255, 0.1), transparent);
            transition: 0.5s;
        }

        .category-card:hover::before {
            left: 100%;
        }

        .category-icon {
            font-size: 3rem;
            color: var(--terminal-blue);
            margin-bottom: 20px;
        }

        .category-title {
            font-size: 1.5rem;
            margin-bottom: 10px;
            color: #fff;
        }

        .category-desc {
            font-size: 0.95rem;
            opacity: 0.8;
            line-height: 1.5;
            margin-bottom: 20px;
        }

        .sub-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }

        .sub-option {
            background: rgba(0, 170, 255, 0.2);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            transition: all 0.2s ease;
        }

        .sub-option:hover {
            background: rgba(0, 170, 255, 0.4);
            transform: scale(1.05);
        }

        /* 終端機頁面樣式 */
        .terminal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 20px;
            background: rgba(0, 20, 40, 0.7);
            border-radius: 15px;
        }

        .terminal-title {
            font-size: 1.8rem;
            color: var(--terminal-blue);
        }

        .os-version-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            background: rgba(0, 0, 0, 0.3);
            padding: 5px;
            border-radius: 8px;
        }

        .os-version {
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .os-version.active {
            background: var(--primary-blue);
        }

        .os-version.win7.active {
            background: var(--win7-blue);
        }

        .os-version.win10.active {
            background: var(--win10-blue);
        }

        .os-version.win11.active {
            background: var(--win11-purple);
        }

        .os-version.linux.active {
            background: #dd4814;
        }

        .terminal-container {
            background: var(--terminal-black);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.7);
            height: 65vh;
            display: flex;
            flex-direction: column;
        }

        .terminal-window-header {
            background: #2d2d2d;
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #444;
        }

        .terminal-window-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
        }

        .terminal-controls {
            display: flex;
            gap: 10px;
        }

        .control-btn {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            cursor: pointer;
        }

        .close-btn { background: #ff5f56; }
        .min-btn { background: #ffbd2e; }
        .max-btn { background: #27ca3f; }

        .terminal-body {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            font-family: 'Consolas', 'Courier New', monospace;
            font-size: 1rem;
            line-height: 1.5;
        }

        /* 導航控制 */
        .nav-controls {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            justify-content: center;
        }

        .nav-btn {
            padding: 12px 25px;
            background: rgba(0, 170, 255, 0.2);
            border: 1px solid rgba(0, 170, 255, 0.4);
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-btn:hover {
            background: rgba(0, 170, 255, 0.4);
            transform: translateY(-2px);
        }

        /* 作業系統特定樣式 */
        .win7-theme {
            background: linear-gradient(135deg, #0d5ca3, #1b7fd8);
        }

        .win10-theme {
            background: linear-gradient(135deg, #0078d7, #005a9e);
        }

        .win11-theme {
            background: linear-gradient(135deg, #5b2be2, #8a2be2);
        }

        .linux-theme {
            background: linear-gradient(135deg, #dd4814, #77216f);
        }

        /* 命令輸出樣式 */
        .terminal-output {
            white-space: pre-wrap;
            word-break: break-word;
            margin-bottom: 10px;
        }

        .command-line {
            display: flex;
            align-items: center;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .prompt {
            color: var(--terminal-green);
            margin-right: 10px;
            white-space: nowrap;
            margin-bottom: 5px;
        }

        .prompt-powershell {
            color: #4fc3f7;
        }

        .prompt-linux {
            color: var(--terminal-yellow);
        }

        .command-input {
            background: transparent;
            border: none;
            color: white;
            font-family: 'Consolas', 'Courier New', monospace;
            font-size: 1rem;
            flex: 1;
            min-width: 200px;
            outline: none;
            caret-color: var(--terminal-green);
            margin-bottom: 5px;
        }

        .output-success {
            color: var(--terminal-green);
        }

        .output-error {
            color: var(--terminal-red);
        }

        .output-info {
            color: #4fc3f7;
        }

        .output-warning {
            color: var(--terminal-yellow);
        }

        .command-history {
            opacity: 0.7;
            margin-bottom: 5px;
        }

        /* 手機專用樣式 */
        .mobile-controls {
            display: none;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .mobile-btn {
            padding: 8px 15px;
            background: rgba(0, 170, 255, 0.3);
            border: 1px solid rgba(0, 170, 255, 0.5);
            border-radius: 5px;
            color: white;
            cursor: pointer;
            font-size: 0.9rem;
        }

        /* 開機畫面 */
        .boot-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: bootFade 3s ease forwards;
        }

        @keyframes bootFade {
            0% { opacity: 1; }
            80% { opacity: 1; }
            100% { opacity: 0; display: none; }
        }

        .boot-logo {
            font-size: 4rem;
            color: var(--terminal-blue);
            margin-bottom: 30px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 0.5; }
            50% { opacity: 1; }
            100% { opacity: 0.5; }
        }

        .boot-text {
            color: #fff;
            font-size: 1.2rem;
            margin-bottom: 20px;
            text-align: center;
        }

        .boot-progress {
            width: 300px;
            height: 3px;
            background: #333;
            border-radius: 2px;
            overflow: hidden;
            margin-top: 20px;
        }

        .boot-progress-bar {
            height: 100%;
            background: var(--terminal-blue);
            width: 0%;
            animation: progressLoad 2.5s ease forwards;
        }

        @keyframes progressLoad {
            to { width: 100%; }
        }

        /* 響應式設計 */
        @media (max-width: 768px) {
            .main-title {
                font-size: 1.8rem;
            }
            
            .main-subtitle {
                font-size: 1rem;
                padding: 0 10px;
            }
            
            .category-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .category-card {
                padding: 20px;
            }
            
            .terminal-header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
                padding: 15px;
            }
            
            .terminal-title {
                font-size: 1.5rem;
            }
            
            .terminal-container {
                height: 60vh;
            }
            
            .nav-controls {
                flex-direction: column;
                gap: 10px;
            }
            
            .nav-btn {
                padding: 10px 20px;
                justify-content: center;
            }
            
            .mobile-controls {
                display: flex;
            }
            
            .os-version-selector {
                justify-content: center;
            }
            
            .os-version {
                padding: 6px 12px;
                font-size: 0.9rem;
            }
            
            .terminal-body {
                padding: 15px;
                font-size: 0.9rem;
            }
            
            .command-input {
                font-size: 0.9rem;
                min-width: 150px;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }
            
            .main-header {
                padding: 20px 15px;
                margin-bottom: 20px;
            }
            
            .main-icon {
                font-size: 3rem;
            }
            
            .terminal-container {
                height: 55vh;
            }
            
            .os-version {
                padding: 5px 10px;
                font-size: 0.8rem;
            }
        }

        /* 觸摸裝置優化 */
        @media (hover: none) and (pointer: coarse) {
            .category-card:hover {
                transform: none;
                border-color: transparent;
            }
            
            .nav-btn:hover {
                transform: none;
            }
            
            .sub-option:hover {
                transform: none;
            }
            
            .os-version:hover {
                background: rgba(255, 255, 255, 0.1);
            }
            
            .os-version.active:hover {
                background: var(--primary-blue);
            }
        }

        /* 動畫 */
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }

        /* 滾動條樣式 */
        .terminal-body::-webkit-scrollbar {
            width: 8px;
        }

        .terminal-body::-webkit-scrollbar-track {
            background: #1a1a1a;
        }

        .terminal-body::-webkit-scrollbar-thumb {
            background: #444;
            border-radius: 4px;
        }

        .terminal-body::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
    </style>
</head>
<body>
    <!-- 開機畫面 -->
    <div class="boot-screen" id="boot-screen">
        <div class="boot-logo">
            <i class="fas fa-terminal"></i>
        </div>
        <div class="boot-text">
            <div>電腦命令提示執行模擬器</div>
            <div>正在載入...</div>
        </div>
        <div class="boot-progress">
            <div class="boot-progress-bar"></div>
        </div>
    </div>

    <div class="container">
        <!-- 主頁 -->
        <div class="page active" id="main-page">
            <header class="main-header">
                <div class="main-icon">
                    <i class="fas fa-terminal"></i>
                </div>
                <h1 class="main-title">電腦命令提示執行模擬器</h1>
                <p class="main-subtitle">
                    這是一個完整的命令提示模擬平台，讓您體驗真實的Windows命令提示字元、PowerShell以及Linux終端機操作。
                    支援多個Windows版本(7/10/11)以及各種Linux發行版。本模擬器完全在瀏覽器中運行，無需安裝任何軟體。
                </p>
                <div class="main-help">
                    <p><i class="fas fa-info-circle"></i> 請點擊下方選項開始模擬體驗</p>
                </div>
            </header>

            <div class="category-grid">
                <div class="category-card" data-page="windows-page">
                    <div class="category-icon">
                        <i class="fab fa-windows"></i>
                    </div>
                    <h2 class="category-title">Windows命令執行模擬器</h2>
                    <p class="category-desc">
                        完整模擬Windows命令提示字元及PowerShell環境，支援Windows 7/10/11各個版本。
                        包含常用的系統命令、檔案操作、網路命令等真實操作體驗。
                    </p>
                    <div class="sub-options">
                        <div class="sub-option">CMD 命令提示字元</div>
                        <div class="sub-option">PowerShell</div>
                        <div class="sub-option">Windows 7/10/11</div>
                    </div>
                </div>

                <div class="category-card" data-page="linux-page">
                    <div class="category-icon">
                        <i class="fab fa-linux"></i>
                    </div>
                    <h2 class="category-title">Linux作業系統命令執行模擬</h2>
                    <p class="category-desc">
                        模擬Linux終端機環境，支援多種發行版命令。包含檔案管理、系統監控、
                        網路設定、軟體安裝等真實命令操作體驗。
                    </p>
                    <div class="sub-options">
                        <div class="sub-option">Bash 終端機</div>
                        <div class="sub-option">Ubuntu/Debian</div>
                        <div class="sub-option">CentOS/RHEL</div>
                    </div>
                </div>
            </div>

            <div class="nav-controls" style="visibility: hidden;">
                <!-- 主頁不需要導航按鈕 -->
            </div>
        </div>

        <!-- Windows 命令頁面 -->
        <div class="page" id="windows-page">
            <div class="terminal-header">
                <h2 class="terminal-title"><i class="fab fa-windows"></i> Windows命令執行模擬器</h2>
                <div class="os-version-selector">
                    <div class="os-version win7 active" data-terminal="cmd" data-version="win7">Windows 7 CMD</div>
                    <div class="os-version win10" data-terminal="cmd" data-version="win10">Windows 10 CMD</div>
                    <div class="os-version win11" data-terminal="cmd" data-version="win11">Windows 11 CMD</div>
                    <div class="os-version win10" data-terminal="powershell" data-version="win10">PowerShell</div>
                </div>
            </div>

            <div class="terminal-container">
                <div class="terminal-window-header">
                    <div class="terminal-window-title">
                        <i class="fas fa-terminal"></i>
                        <span id="windows-terminal-name">Windows 7 命令提示字元</span>
                    </div>
                    <div class="terminal-controls">
                        <div class="control-btn close-btn" onclick="goHome()"></div>
                        <div class="control-btn min-btn" onclick="minimizeTerminal('windows')"></div>
                        <div class="control-btn max-btn" onclick="maximizeTerminal('windows')"></div>
                    </div>
                </div>
                <div class="terminal-body" id="windows-terminal-output">
                    <div class="terminal-output output-info">
Microsoft Windows [版本 6.1.7601]<br/>
版權所有 (c) 2009 Microsoft Corporation。保留所有權利。<br/>
<br/>
C:\Users\Admin&gt;help<br/>
輸入命令名稱以取得詳細資訊，或輸入 help 以查看可用命令清單。<br/>
========================================
                    </div>
                    <div class="command-line">
                        <span class="prompt" id="windows-prompt">C:\Users\Admin&gt;</span>
                        <input type="text" class="command-input" id="windows-command-input" autocomplete="off" autofocus>
                    </div>
                </div>
            </div>

            <!-- 手機專用按鈕 -->
            <div class="mobile-controls">
                <button class="mobile-btn" onclick="executeCommonWindowsCommand('dir')">dir</button>
                <button class="mobile-btn" onclick="executeCommonWindowsCommand('ipconfig')">ipconfig</button>
                <button class="mobile-btn" onclick="executeCommonWindowsCommand('ping localhost')">ping</button>
                <button class="mobile-btn" onclick="executeCommonWindowsCommand('help')">help</button>
                <button class="mobile-btn" onclick="executeCommonWindowsCommand('cls')">cls</button>
            </div>

            <div class="nav-controls">
                <button class="nav-btn" onclick="goBack()">
                    <i class="fas fa-arrow-left"></i> 返回上一頁
                </button>
                <button class="nav-btn" onclick="goHome()">
                    <i class="fas fa-home"></i> 返回主頁
                </button>
                <button class="nav-btn" onclick="clearTerminal('windows')">
                    <i class="fas fa-broom"></i> 清除畫面
                </button>
            </div>
        </div>

        <!-- Linux 命令頁面 -->
        <div class="page" id="linux-page">
            <div class="terminal-header">
                <h2 class="terminal-title"><i class="fab fa-linux"></i> Linux作業系統命令執行模擬</h2>
                <div class="os-version-selector">
                    <div class="os-version linux active" data-linux="ubuntu">Ubuntu 22.04</div>
                    <div class="os-version linux" data-linux="centos">CentOS 8</div>
                    <div class="os-version linux" data-linux="debian">Debian 11</div>
                </div>
            </div>

            <div class="terminal-container">
                <div class="terminal-window-header">
                    <div class="terminal-window-title">
                        <i class="fas fa-terminal"></i>
                        <span id="linux-terminal-name">Ubuntu 22.04.3 LTS</span>
                    </div>
                    <div class="terminal-controls">
                        <div class="control-btn close-btn" onclick="goHome()"></div>
                        <div class="control-btn min-btn" onclick="minimizeTerminal('linux')"></div>
                        <div class="control-btn max-btn" onclick="maximizeTerminal('linux')"></div>
                    </div>
                </div>
                <div class="terminal-body" id="linux-terminal-output">
                    <div class="terminal-output output-info">
Welcome to Ubuntu 22.04.3 LTS (GNU/Linux 5.15.0-86-generic x86_64)<br/>
<br/>
 * Documentation:  https://help.ubuntu.com<br/>
 * Management:     https://landscape.canonical.com<br/>
 * Support:        https://ubuntu.com/advantage<br/>
<br/>
System information as of Sun Oct 15 14:30:00 CST 2023<br/>
<br/>
System load:  0.08               Processes:             245<br/>
Usage of /:   24.8% of 48.28GB   Users logged in:       1<br/>
Memory usage: 42%                IPv4 address for eth0: 192.168.1.100<br/>
Swap usage:   0%<br/>
<br/>
0 updates can be applied immediately.<br/>
<br/>
Last login: Sun Oct 15 14:25:01 2023 from 192.168.1.50<br/>
========================================
                    </div>
                    <div class="command-line">
                        <span class="prompt prompt-linux" id="linux-prompt">user@ubuntu:~$</span>
                        <input type="text" class="command-input" id="linux-command-input" autocomplete="off" autofocus>
                    </div>
                </div>
            </div>

            <!-- 手機專用按鈕 -->
            <div class="mobile-controls">
                <button class="mobile-btn" onclick="executeCommonLinuxCommand('ls')">ls</button>
                <button class="mobile-btn" onclick="executeCommonLinuxCommand('pwd')">pwd</button>
                <button class="mobile-btn" onclick="executeCommonLinuxCommand('neofetch')">neofetch</button>
                <button class="mobile-btn" onclick="executeCommonLinuxCommand('help')">help</button>
                <button class="mobile-btn" onclick="executeCommonLinuxCommand('clear')">clear</button>
            </div>

            <div class="nav-controls">
                <button class="nav-btn" onclick="goBack()">
                    <i class="fas fa-arrow-left"></i> 返回上一頁
                </button>
                <button class="nav-btn" onclick="goHome()">
                    <i class="fas fa-home"></i> 返回主頁
                </button>
                <button class="nav-btn" onclick="clearTerminal('linux')">
                    <i class="fas fa-broom"></i> 清除畫面
                </button>
            </div>
        </div>
    </div>

    <script>
        // 模擬器狀態
        const state = {
            currentPage: 'main-page',
            previousPage: null,
            terminalMode: 'cmd',
            osVersion: 'win7',
            linuxDistro: 'ubuntu',
            commandHistory: { windows: [], linux: [] },
            historyIndex: -1,
            currentDir: 'C:\\Users\\Admin',
            linuxDir: '/home/user',
            filesystem: {
                windows: {
                    'C:\\': ['Users', 'Windows', 'Program Files'],
                    'C:\\Users': ['Admin', 'Public', 'Default'],
                    'C:\\Users\\Admin': ['Desktop', 'Documents', 'Downloads', 'file1.txt', 'file2.txt']
                },
                linux: {
                    '/': ['home', 'etc', 'usr', 'bin'],
                    '/home': ['user', 'guest'],
                    '/home/user': ['Desktop', 'Documents', 'Downloads', 'file1.txt', 'file2.txt']
                }
            },
            terminalMaximized: {
                windows: false,
                linux: false
            }
        };

        // 檢查是否為移動裝置
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 隱藏開機畫面
            setTimeout(() => {
                document.getElementById('boot-screen').style.display = 'none';
            }, 3000);
            
            // 設定頁面切換
            setupPageNavigation();
            
            // 設定終端機
            setupTerminals();
            
            // 如果是移動裝置，優化體驗
            if (isMobile) {
                optimizeForMobile();
            }
            
            // 設定輸入框自動聚焦
            setTimeout(() => {
                const activeInput = document.querySelector('.page.active .command-input');
                if (activeInput) {
                    activeInput.focus();
                }
            }, 100);
        });

        // 設定頁面導航
        function setupPageNavigation() {
            // 主頁卡片點擊
            document.querySelectorAll('.category-card').forEach(card => {
                card.addEventListener('click', function() {
                    const pageId = this.dataset.page;
                    navigateTo(pageId);
                });
            });

            // Windows版本選擇
            document.querySelectorAll('.os-version[data-terminal]').forEach(option => {
                option.addEventListener('click', function() {
                    const terminal = this.dataset.terminal;
                    const version = this.dataset.version;
                    switchWindowsTerminal(terminal, version);
                });
            });

            // Linux版本選擇
            document.querySelectorAll('.os-version[data-linux]').forEach(option => {
                option.addEventListener('click', function() {
                    const distro = this.dataset.linux;
                    switchLinuxDistro(distro);
                });
            });
        }

        // 導航到頁面
        function navigateTo(pageId) {
            const currentPage = document.querySelector('.page.active');
            if (currentPage) {
                state.previousPage = currentPage.id;
                currentPage.classList.remove('active');
            }
            
            state.currentPage = pageId;
            document.getElementById(pageId).classList.add('active');
            
            // 更新標題和背景
            updatePageTheme();
            
            // 聚焦輸入框
            setTimeout(() => {
                const input = document.querySelector(`#${pageId} .command-input`);
                if (input) {
                    input.focus();
                }
            }, 50);
        }

        // 返回上一頁
        function goBack() {
            if (state.previousPage) {
                navigateTo(state.previousPage);
            } else {
                goHome();
            }
        }

        // 返回主頁
        function goHome() {
            navigateTo('main-page');
        }

        // 清除終端畫面
        function clearTerminal(type) {
            const terminal = document.getElementById(`${type}-terminal-output`);
            const outputs = terminal.querySelectorAll('.terminal-output');
            outputs.forEach(output => {
                if (!output.classList.contains('command-history')) {
                    output.remove();
                }
            });
            
            if (type === 'windows') {
                addWindowsOutput('畫面已清除。', 'info');
            } else {
                addLinuxOutput('畫面已清除。', 'info');
            }
        }

        // 最小化終端
        function minimizeTerminal(type) {
            const container = document.querySelector(`#${type}-page .terminal-container`);
            container.style.height = '100px';
            container.style.transition = 'height 0.3s ease';
        }

        // 最大化終端
        function maximizeTerminal(type) {
            const container = document.querySelector(`#${type}-page .terminal-container`);
            if (state.terminalMaximized[type]) {
                container.style.height = '65vh';
                if (window.innerWidth <= 768) {
                    container.style.height = '60vh';
                }
                state.terminalMaximized[type] = false;
            } else {
                container.style.height = '80vh';
                state.terminalMaximized[type] = true;
            }
        }

        // 更新頁面主題
        function updatePageTheme() {
            const body = document.body;
            body.className = '';
            
            switch(state.currentPage) {
                case 'windows-page':
                    body.classList.add(`${state.osVersion}-theme`);
                    break;
                case 'linux-page':
                    body.classList.add('linux-theme');
                    break;
                default:
                    break;
            }
        }

        // 設定終端機
        function setupTerminals() {
            // Windows命令輸入
            const windowsInput = document.getElementById('windows-command-input');
            windowsInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    executeWindowsCommand(this.value.trim());
                    this.value = '';
                    state.historyIndex = -1;
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    navigateWindowsHistory('up');
                } else if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    navigateWindowsHistory('down');
                } else if (e.key === 'Tab') {
                    e.preventDefault();
                    autoCompleteWindowsCommand(this.value);
                }
            });

            // Linux命令輸入
            const linuxInput = document.getElementById('linux-command-input');
            linuxInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    executeLinuxCommand(this.value.trim());
                    this.value = '';
                    state.historyIndex = -1;
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    navigateLinuxHistory('up');
                } else if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    navigateLinuxHistory('down');
                } else if (e.key === 'Tab') {
                    e.preventDefault();
                    autoCompleteLinuxCommand(this.value);
                }
            });

            // 點擊終端機時聚焦輸入框
            document.querySelectorAll('.terminal-body').forEach(body => {
                body.addEventListener('click', function() {
                    const input = this.querySelector('.command-input');
                    if (input) {
                        input.focus();
                    }
                });
            });
        }

        // 優化移動裝置體驗
        function optimizeForMobile() {
            // 增加按鈕觸控區域
            document.querySelectorAll('.nav-btn, .mobile-btn').forEach(btn => {
                btn.style.minHeight = '44px';
            });
            
            // 防止縮放
            document.addEventListener('touchstart', function(e) {
                if (e.touches.length > 1) {
                    e.preventDefault();
                }
            }, { passive: false });
            
            // 防止雙擊縮放
            let lastTouchEnd = 0;
            document.addEventListener('touchend', function(e) {
                const now = Date.now();
                if (now - lastTouchEnd <= 300) {
                    e.preventDefault();
                }
                lastTouchEnd = now;
            }, false);
        }

        // 執行常用Windows命令（手機按鈕）
        function executeCommonWindowsCommand(cmd) {
            const input = document.getElementById('windows-command-input');
            input.value = cmd;
            executeWindowsCommand(cmd);
            input.value = '';
            state.historyIndex = -1;
        }

        // 執行常用Linux命令（手機按鈕）
        function executeCommonLinuxCommand(cmd) {
            const input = document.getElementById('linux-command-input');
            input.value = cmd;
            executeLinuxCommand(cmd);
            input.value = '';
            state.historyIndex = -1;
        }

        // 切換Windows終端機
        function switchWindowsTerminal(terminal, version) {
            state.terminalMode = terminal;
            state.osVersion = version;
            
            // 更新選中狀態
            document.querySelectorAll('.os-version[data-terminal]').forEach(option => {
                option.classList.remove('active');
            });
            document.querySelector(`.os-version[data-terminal="${terminal}"][data-version="${version}"]`).classList.add('active');
            
            // 更新終端機名稱和提示
            const terminalName = document.getElementById('windows-terminal-name');
            const prompt = document.getElementById('windows-prompt');
            
            if (terminal === 'powershell') {
                terminalName.textContent = 'Windows PowerShell';
                prompt.textContent = 'PS C:\\Users\\Admin>';
                prompt.className = 'prompt prompt-powershell';
            } else {
                terminalName.textContent = `Windows ${version.replace('win', '')} 命令提示字元`;
                prompt.textContent = 'C:\\Users\\Admin>';
                prompt.className = 'prompt';
            }
            
            // 更新主題
            updatePageTheme();
            
            // 顯示切換訊息
            addWindowsOutput(`已切換到 ${terminal === 'cmd' ? '命令提示字元' : 'PowerShell'} (Windows ${version.replace('win', '')})`, 'info');
            
            // 聚焦輸入框
            setTimeout(() => {
                document.getElementById('windows-command-input').focus();
            }, 50);
        }

        // 切換Linux發行版
        function switchLinuxDistro(distro) {
            state.linuxDistro = distro;
            
            // 更新選中狀態
            document.querySelectorAll('.os-version[data-linux]').forEach(option => {
                option.classList.remove('active');
            });
            document.querySelector(`.os-version[data-linux="${distro}"]`).classList.add('active');
            
            // 更新終端機名稱和提示
            const terminalName = document.getElementById('linux-terminal-name');
            const prompt = document.getElementById('linux-prompt');
            
            switch(distro) {
                case 'ubuntu':
                    terminalName.textContent = 'Ubuntu 22.04.3 LTS';
                    prompt.textContent = 'user@ubuntu:~$';
                    break;
                case 'centos':
                    terminalName.textContent = 'CentOS Linux 8';
                    prompt.textContent = '[user@centos ~]$';
                    break;
                case 'debian':
                    terminalName.textContent = 'Debian GNU/Linux 11';
                    prompt.textContent = 'user@debian:~$';
                    break;
            }
            
            // 顯示切換訊息
            addLinuxOutput(`已切換到 ${distro.charAt(0).toUpperCase() + distro.slice(1)} 發行版`, 'info');
            
            // 聚焦輸入框
            setTimeout(() => {
                document.getElementById('linux-command-input').focus();
            }, 50);
        }

        // Windows命令自動完成
        function autoCompleteWindowsCommand(partial) {
            const commands = Object.keys(cmdCommands).concat(Object.keys(powershellCommands));
            const matches = commands.filter(cmd => cmd.startsWith(partial.toLowerCase()));
            
            if (matches.length === 1) {
                document.getElementById('windows-command-input').value = matches[0];
            } else if (matches.length > 1) {
                addWindowsOutput(`可能的命令: ${matches.join(', ')}`, 'info');
            }
        }

        // Linux命令自動完成
        function autoCompleteLinuxCommand(partial) {
            const commands = Object.keys(linuxCommands);
            const matches = commands.filter(cmd => cmd.startsWith(partial.toLowerCase()));
            
            if (matches.length === 1) {
                document.getElementById('linux-command-input').value = matches[0];
            } else if (matches.length > 1) {
                addLinuxOutput(`可能的命令: ${matches.join(', ')}`, 'info');
            }
        }

        // 導航Windows歷史記錄
        function navigateWindowsHistory(direction) {
            if (state.commandHistory.windows.length === 0) return;
            
            if (direction === 'up') {
                if (state.historyIndex < state.commandHistory.windows.length - 1) {
                    state.historyIndex++;
                }
            } else {
                if (state.historyIndex > 0) {
                    state.historyIndex--;
                } else if (state.historyIndex === 0) {
                    state.historyIndex = -1;
                    document.getElementById('windows-command-input').value = '';
                    return;
                }
            }
            
            if (state.historyIndex >= 0) {
                document.getElementById('windows-command-input').value = 
                    state.commandHistory.windows[state.commandHistory.windows.length - 1 - state.historyIndex];
            }
        }

        // 導航Linux歷史記錄
        function navigateLinuxHistory(direction) {
            if (state.commandHistory.linux.length === 0) return;
            
            if (direction === 'up') {
                if (state.historyIndex < state.commandHistory.linux.length - 1) {
                    state.historyIndex++;
                }
            } else {
                if (state.historyIndex > 0) {
                    state.historyIndex--;
                } else if (state.historyIndex === 0) {
                    state.historyIndex = -1;
                    document.getElementById('linux-command-input').value = '';
                    return;
                }
            }
            
            if (state.historyIndex >= 0) {
                document.getElementById('linux-command-input').value = 
                    state.commandHistory.linux[state.commandHistory.linux.length - 1 - state.historyIndex];
            }
        }

        // 執行Windows命令
        function executeWindowsCommand(cmd) {
            if (!cmd) return;
            
            // 儲存到歷史記錄
            state.commandHistory.windows.push(cmd);
            if (state.commandHistory.windows.length > 50) {
                state.commandHistory.windows.shift();
            }
            
            // 顯示命令
            addWindowsOutput(`${document.getElementById('windows-prompt').textContent} ${cmd}`, 'command-history');
            
            // 執行命令
            if (state.terminalMode === 'powershell') {
                executePowerShellCommand(cmd);
            } else {
                executeCMDCommand(cmd);
            }
            
            // 滾動到底部
            setTimeout(() => {
                const terminal = document.getElementById('windows-terminal-output');
                terminal.scrollTop = terminal.scrollHeight;
            }, 10);
        }

        // 執行CMD命令
        function executeCMDCommand(cmd) {
            const parts = cmd.split(' ');
            const command = parts[0].toLowerCase();
            const args = parts.slice(1);
            
            if (cmd === 'exit') {
                goHome();
                return;
            }
            
            if (cmdCommands[command]) {
                cmdCommands[command](args);
            } else {
                addWindowsOutput(`'${command}' 不是內部或外部命令、可執行的程式或批次檔。`, 'error');
            }
        }

        // 執行PowerShell命令
        function executePowerShellCommand(cmd) {
            const parts = cmd.split(' ');
            const command = parts[0].toLowerCase();
            const args = parts.slice(1);
            
            if (cmd === 'exit') {
                goHome();
                return;
            }
            
            if (powershellCommands[command]) {
                powershellCommands[command](args);
            } else {
                addWindowsOutput(`${command}: 無法辨識 '${command}' 詞彙是否為 Cmdlet、函數、指令檔或可執行程式的名稱。`, 'error');
            }
        }

        // 執行Linux命令
        function executeLinuxCommand(cmd) {
            if (!cmd) return;
            
            // 儲存到歷史記錄
            state.commandHistory.linux.push(cmd);
            if (state.commandHistory.linux.length > 50) {
                state.commandHistory.linux.shift();
            }
            
            // 顯示命令
            addLinuxOutput(`${document.getElementById('linux-prompt').textContent} ${cmd}`, 'command-history');
            
            // 執行命令
            const command = cmd.split(' ')[0].toLowerCase();
            const args = cmd.split(' ').slice(1);
            
            if (cmd === 'exit') {
                goHome();
                return;
            }
            
            if (linuxCommands[command]) {
                linuxCommands[command](args);
            } else {
                addLinuxOutput(`-bash: ${command}: command not found`, 'error');
            }
            
            // 滾動到底部
            setTimeout(() => {
                const terminal = document.getElementById('linux-terminal-output');
                terminal.scrollTop = terminal.scrollHeight;
            }, 10);
        }

        // 新增輸出到Windows終端機
        function addWindowsOutput(text, type = 'normal') {
            const output = document.createElement('div');
            output.className = `terminal-output output-${type}`;
            output.textContent = text;
            
            const terminal = document.getElementById('windows-terminal-output');
            const commandLine = terminal.querySelector('.command-line');
            terminal.insertBefore(output, commandLine);
        }

        // 新增輸出到Linux終端機
        function addLinuxOutput(text, type = 'normal') {
            const output = document.createElement('div');
            output.className = `terminal-output output-${type}`;
            output.textContent = text;
            
            const terminal = document.getElementById('linux-terminal-output');
            const commandLine = terminal.querySelector('.command-line');
            terminal.insertBefore(output, commandLine);
        }

        // CMD命令集（擴充）
        const cmdCommands = {
            help: () => {
                addWindowsOutput('有關某個命令的詳細資訊，請輸入 HELP 命令名', 'info');
                addWindowsOutput('ASSOC          顯示或修改副檔名關聯。');
                addWindowsOutput('ATTRIB         顯示或變更檔案屬性。');
                addWindowsOutput('CD             顯示目前目錄的名稱或變更目錄。');
                addWindowsOutput('CLS            清除畫面。');
                addWindowsOutput('COPY           將一個或多個檔案複製到其他位置。');
                addWindowsOutput('DATE           顯示或設定日期。');
                addWindowsOutput('DIR            顯示目錄中的檔案和子目錄清單。');
                addWindowsOutput('ECHO           顯示訊息，或開啟/關閉命令回應。');
                addWindowsOutput('EXIT           結束 CMD.EXE 程式 (命令直譯器)。');
                addWindowsOutput('HELP           提供 Windows 命令的說明資訊。');
                addWindowsOutput('IPCONFIG       顯示所有目前的 TCP/IP 網路組態值。');
                addWindowsOutput('MD             建立目錄。');
                addWindowsOutput('PING           測試網路連線。');
                addWindowsOutput('SYSTEMINFO     顯示電腦的特定屬性和組態。');
                addWindowsOutput('TASKLIST       顯示所有目前執行的工作。');
                addWindowsOutput('TIME           顯示或設定系統時間。');
                addWindowsOutput('VER            顯示 Windows 版本。');
                addWindowsOutput('WHOAMI         顯示目前使用者名稱。');
                addWindowsOutput('TREE           以圖形顯示磁碟機或路徑的資料夾結構。');
            },
            
            dir: (args) => {
                let targetDir = state.currentDir;
                if (args.length > 0) {
                    if (args[0].startsWith('C:\\')) {
                        targetDir = args[0];
                    } else {
                        targetDir = state.currentDir + '\\' + args[0];
                    }
                }
                
                const dir = state.filesystem.windows[targetDir] || [];
                addWindowsOutput(` ${targetDir} 的目錄`, 'info');
                addWindowsOutput('');
                
                let fileCount = 0;
                let dirCount = 0;
                
                dir.forEach(item => {
                    if (item.includes('.')) {
                        addWindowsOutput(` ${new Date().toLocaleDateString().replace(/\//g, '/')}  ${new Date().toLocaleTimeString().slice(0,5)}              ${item}`);
                        fileCount++;
                    } else {
                        addWindowsOutput(` ${new Date().toLocaleDateString().replace(/\//g, '/')}  ${new Date().toLocaleTimeString().slice(0,5)}    <DIR>          ${item}`);
                        dirCount++;
                    }
                });
                
                addWindowsOutput(`                ${fileCount} 個檔案`);
                addWindowsOutput(`                ${dirCount} 個目錄`);
            },
            
            cls: () => {
                const terminal = document.getElementById('windows-terminal-output');
                const outputs = terminal.querySelectorAll('.terminal-output');
                outputs.forEach(output => {
                    if (!output.classList.contains('command-history')) {
                        output.remove();
                    }
                });
                addWindowsOutput('畫面已清除。', 'info');
            },
            
            cd: (args) => {
                if (args.length === 0) {
                    addWindowsOutput(state.currentDir, 'info');
                    return;
                }
                
                const target = args[0];
                if (target === '..') {
                    // 回到上一層
                    const parts = state.currentDir.split('\\');
                    parts.pop();
                    if (parts.length === 1) {
                        state.currentDir = parts[0] + '\\';
                    } else {
                        state.currentDir = parts.join('\\');
                    }
                    addWindowsOutput(state.currentDir, 'info');
                } else if (state.filesystem.windows[state.currentDir + '\\' + target]) {
                    // 進入子目錄
                    state.currentDir = state.currentDir + '\\' + target;
                    addWindowsOutput(state.currentDir, 'info');
                } else {
                    addWindowsOutput(`系統找不到指定的路徑。`, 'error');
                }
                
                // 更新提示
                document.getElementById('windows-prompt').textContent = 
                    state.currentDir + (state.terminalMode === 'powershell' ? '>' : '>');
            },
            
            ver: () => {
                let version;
                switch(state.osVersion) {
                    case 'win7': version = 'Microsoft Windows [版本 6.1.7601]'; break;
                    case 'win10': version = 'Microsoft Windows [版本 10.0.19045]'; break;
                    case 'win11': version = 'Microsoft Windows [版本 10.0.22621]'; break;
                }
                addWindowsOutput(version, 'info');
            },
            
            ipconfig: () => {
                addWindowsOutput('Windows IP 設定', 'info');
                addWindowsOutput('');
                addWindowsOutput('乙太網路卡 乙太網路:');
                addWindowsOutput('');
                addWindowsOutput('   連線特定 DNS 尾碼 . . . . . . . . : localdomain');
                addWindowsOutput('   連結-本機 IPv6 位址 . . . . . . . : fe80::1234:5678:90ab:cdef%12');
                addWindowsOutput('   IPv4 位址 . . . . . . . . . . . . : 192.168.1.100');
                addWindowsOutput('   子網路遮罩 . . . . . . . . . . . . : 255.255.255.0');
                addWindowsOutput('   預設閘道 . . . . . . . . . . . . . : 192.168.1.1');
                addWindowsOutput('');
                addWindowsOutput('乙太網路卡 乙太網路 2:');
                addWindowsOutput('');
                addWindowsOutput('   媒體狀態 . . . . . . . . . . . . . : 媒體已中斷連線');
                addWindowsOutput('   連線特定 DNS 尾碼 . . . . . . . . :');
            },
            
            ping: (args) => {
                if (!args.length) {
                    addWindowsOutput('必須指定主機名稱。', 'error');
                    return;
                }
                
                const host = args[0];
                addWindowsOutput(`正在 Ping ${host} [127.0.0.1] 具有 32 位元組的資料:`, 'info');
                
                for (let i = 0; i < 4; i++) {
                    const time = Math.floor(Math.random() * 50) + 10;
                    addWindowsOutput(`回覆自 127.0.0.1: 位元組=32 時間=${time}ms TTL=64`, 'success');
                }
                
                addWindowsOutput('');
                addWindowsOutput(`${host} 的 Ping 統計資料:`);
                addWindowsOutput(`    封包: 已傳送 = 4，已收到 = 4，已遺失 = 0 (0% 遺失)`);
                addWindowsOutput(`大約的來回時間 (毫秒):`);
                addWindowsOutput(`    最小值 = 10ms，最大值 = 59ms，平均 = 34ms`);
            },
            
            systeminfo: () => {
                let osName;
                switch(state.osVersion) {
                    case 'win7': osName = 'Microsoft Windows 7 專業版'; break;
                    case 'win10': osName = 'Microsoft Windows 10 專業版'; break;
                    case 'win11': osName = 'Microsoft Windows 11 專業版'; break;
                }
                
                addWindowsOutput('主機名稱: DESKTOP-SIMULATOR', 'info');
                addWindowsOutput(`OS 名稱: ${osName}`);
                addWindowsOutput('OS 製造商: Microsoft Corporation');
                addWindowsOutput('OS 組態: 獨立工作站');
                addWindowsOutput('OS 建立類型: Multiprocessor Free');
                addWindowsOutput('系統類型: x64-based PC');
                addWindowsOutput('處理器: Intel(R) Core(TM) i7-12700K CPU @ 3.60GHz');
                addWindowsOutput('BIOS 版本: American Megatrends Inc. 2.20.1271');
                addWindowsOutput('實體記憶體總計: 16,384 MB');
                addWindowsOutput('可用實體記憶體: 8,192 MB');
                addWindowsOutput('虛擬記憶體: 大小上限: 18,944 MB');
                addWindowsOutput('虛擬記憶體: 可用: 9,472 MB');
                addWindowsOutput('網域: WORKGROUP');
            },
            
            tasklist: () => {
                addWindowsOutput('映像名稱                    PID 工作階段名稱    工作階段#    記憶體使用量', 'info');
                addWindowsOutput('========================= ======== ================ =========== ============');
                addWindowsOutput('System Idle Process              0 Services                   0         24 K');
                addWindowsOutput('System                           4 Services                   0      2,384 K');
                addWindowsOutput('smss.exe                       460 Services                   0      1,104 K');
                addWindowsOutput('csrss.exe                      608 Services                   0      6,712 K');
                addWindowsOutput('wininit.exe                    696 Services                   0      5,820 K');
                addWindowsOutput('services.exe                   772 Services                   0      9,812 K');
                addWindowsOutput('lsass.exe                      780 Services                   0     17,432 K');
                addWindowsOutput('svchost.exe                    904 Services                   0     12,336 K');
                addWindowsOutput('svchost.exe                    976 Services                   0     11,224 K');
                addWindowsOutput('svchost.exe                   1064 Services                   0     15,672 K');
            },
            
            whoami: () => {
                addWindowsOutput('desktop-simulator\\admin', 'info');
            },
            
            date: () => {
                const now = new Date();
                addWindowsOutput(`目前日期: ${now.toLocaleDateString('zh-TW')}`, 'info');
                addWindowsOutput('輸入新日期: (yyyy-mm-dd)');
            },
            
            time: () => {
                const now = new Date();
                addWindowsOutput(`目前時間: ${now.toLocaleTimeString('zh-TW')}`, 'info');
                addWindowsOutput('輸入新時間:');
            },
            
            echo: (args) => {
                addWindowsOutput(args.join(' '), 'info');
            },
            
            md: (args) => {
                if (!args.length) {
                    addWindowsOutput('語法錯誤。', 'error');
                    return;
                }
                
                const dirName = args[0];
                const newDir = state.currentDir + '\\' + dirName;
                
                if (!state.filesystem.windows[newDir]) {
                    state.filesystem.windows[newDir] = [];
                    state.filesystem.windows[state.currentDir].push(dirName);
                    addWindowsOutput(`已建立目錄: ${newDir}`, 'success');
                } else {
                    addWindowsOutput('子目錄或檔案已經存在。', 'error');
                }
            }
        };

        // PowerShell命令集
        const powershellCommands = {
            'get-help': () => {
                addWindowsOutput('名稱', 'info');
                addWindowsOutput('    Get-Help');
                addWindowsOutput('');
                addWindowsOutput('摘要');
                addWindowsOutput('    顯示 PowerShell 命令和概念的相關資訊。');
                addWindowsOutput('');
                addWindowsOutput('語法');
                addWindowsOutput('    Get-Help [[-Name] <String>] [<CommonParameters>]');
                addWindowsOutput('');
                addWindowsOutput('相關連結');
                addWindowsOutput('    Online Version: https://docs.microsoft.com/powershell/module/microsoft.powershell.core/get-help');
                addWindowsOutput('    Get-Command');
                addWindowsOutput('    Get-Module');
            },
            
            'get-process': () => {
                addWindowsOutput('Handles  NPM(K)    PM(K)      WS(K) VM(M)   CPU(s)     Id ProcessName', 'info');
                addWindowsOutput('-------  ------    -----      ----- -----   ------     -- -----------');
                addWindowsOutput('    101       8     2460       4508    74     0.05   1000 csrss');
                addWindowsOutput('    233      12     3452       7840   112     1.23   1204 explorer');
                addWindowsOutput('     56       4     1120       3216    48     0.02    692 lsass');
                addWindowsOutput('     89       6     2344       5128    82     0.45    840 powershell');
                addWindowsOutput('    210      10     4120       8936   124     2.10    988 svchost');
                addWindowsOutput('    156       7     2984       6232    92     0.78   1232 taskhostw');
                addWindowsOutput('    324      15     5216      11248   168     3.45   1456 firefox');
            },
            
            'get-service': () => {
                addWindowsOutput('Status   Name               DisplayName', 'info');
                addWindowsOutput('------   ----               -----------');
                addWindowsOutput('Running  Audiosrv           Windows Audio');
                addWindowsOutput('Running  BFE                Base Filtering Engine');
                addWindowsOutput('Running  CryptSvc           Cryptographic Services');
                addWindowsOutput('Stopped  Fax                Fax');
                addWindowsOutput('Running  LanmanServer       Server');
                addWindowsOutput('Running  Schedule           Task Scheduler');
                addWindowsOutput('Running  WinRM              Windows Remote Management');
                addWindowsOutput('Running  WpnService         Windows Push Notifications Service');
                addWindowsOutput('Stopped  WSearch            Windows Search');
                addWindowsOutput('Running  WUauserv           Windows Update');
            },
            
            'get-date': () => {
                const now = new Date();
                addWindowsOutput(now.toString(), 'info');
                addWindowsOutput('');
                addWindowsOutput('DateTime              : ' + now.toISOString());
                addWindowsOutput('Date                  : ' + now.toISOString().split('T')[0]);
                addWindowsOutput('Day                   : ' + now.getDate());
                addWindowsOutput('DayOfWeek             : ' + now.getDay());
                addWindowsOutput('DayOfYear             : ' + Math.floor((now - new Date(now.getFullYear(), 0, 0)) / 86400000));
                addWindowsOutput('Kind                  : Local');
                addWindowsOutput('Millisecond           : ' + now.getMilliseconds());
                addWindowsOutput('Minute                : ' + now.getMinutes());
                addWindowsOutput('Month                 : ' + (now.getMonth() + 1));
                addWindowsOutput('Second                : ' + now.getSeconds());
                addWindowsOutput('Ticks                 : ' + (now.getTime() * 10000 + 621355968000000000));
                addWindowsOutput('TimeOfDay             : ' + now.toTimeString().split(' ')[0]);
                addWindowsOutput('Year                  : ' + now.getFullYear());
            },
            
            'get-computerinfo': () => {
                addWindowsOutput('WindowsProductName      : Microsoft Windows 11 專業版', 'info');
                addWindowsOutput('WindowsVersion          : 22H2');
                addWindowsOutput('WindowsBuildLabEx       : 22621.2428.amd64fre.ni_release.220506-1250');
                addWindowsOutput('OsArchitecture          : 64-bit');
                addWindowsOutput('OsMuiLanguages          : {zh-TW}');
                addWindowsOutput('CsNumberOfProcessors    : 16');
                addWindowsOutput('CsProcessors            : Intel(R) Core(TM) i7-12700K');
                addWindowsOutput('CsTotalPhysicalMemory   : 17,179,869,184');
                addWindowsOutput('CsPhyicallyInstalledMemory : 16,384');
                addWindowsOutput('CsDomain                : WORKGROUP');
                addWindowsOutput('CsDomainRole           : StandaloneWorkstation');
                addWindowsOutput('CsHypervisorPresent    : False');
                addWindowsOutput('CsNetworkAdapters      : {乙太網路, Wi-Fi}');
            },
            
            'get-childitem': (args) => {
                cmdCommands.dir(args);
            },
            
            'clear-host': () => {
                cmdCommands.cls();
            }
        };

        // Linux命令集（擴充）
        const linuxCommands = {
            help: () => {
                addLinuxOutput('常用命令:', 'info');
                addLinuxOutput('  ls          - 列出目錄內容');
                addLinuxOutput('  cd          - 變更目錄');
                addLinuxOutput('  pwd         - 顯示目前目錄');
                addLinuxOutput('  cat         - 顯示檔案內容');
                addLinuxOutput('  grep        - 搜尋文字');
                addLinuxOutput('  ps          - 顯示程序狀態');
                addLinuxOutput('  top         - 顯示系統程序');
                addLinuxOutput('  df          - 顯示磁碟使用情況');
                addLinuxOutput('  free        - 顯示記憶體使用情況');
                addLinuxOutput('  uname       - 顯示系統資訊');
                addLinuxOutput('  whoami      - 顯示目前使用者');
                addLinuxOutput('  date        - 顯示日期和時間');
                addLinuxOutput('  clear       - 清除終端畫面');
                addLinuxOutput('  neofetch    - 顯示系統資訊（美觀版）');
                addLinuxOutput('  mkdir       - 建立目錄');
                addLinuxOutput('  touch       - 建立檔案');
                addLinuxOutput('  rm          - 刪除檔案或目錄');
                addLinuxOutput('  cp          - 複製檔案或目錄');
                addLinuxOutput('  mv          - 移動或重新命名檔案');
            },
            
            ls: (args) => {
                let targetDir = state.linuxDir;
                let options = '';
                
                if (args.length > 0) {
                    if (args[0].startsWith('-')) {
                        options = args[0];
                        if (args.length > 1) {
                            targetDir = args[1];
                        }
                    } else {
                        targetDir = args[0];
                    }
                }
                
                if (targetDir.startsWith('/')) {
                    // 絕對路徑
                } else if (targetDir !== '.') {
                    targetDir = state.linuxDir + '/' + targetDir;
                }
                
                const dir = state.filesystem.linux[targetDir] || [];
                const showDetails = options.includes('l');
                
                if (showDetails) {
                    addLinuxOutput(`總計 ${dir.length * 4}`, 'info');
                    
                    dir.forEach(item => {
                        if (item.includes('.')) {
                            addLinuxOutput(`-rw-r--r-- 1 user user  1024 Oct 15 14:30 ${item}`);
                        } else {
                            addLinuxOutput(`drwxr-xr-x 2 user user  4096 Oct 15 14:30 ${item}`);
                        }
                    });
                } else {
                    dir.forEach(item => {
                        addLinuxOutput(item);
                    });
                }
            },
            
            pwd: () => {
                addLinuxOutput(state.linuxDir, 'info');
            },
            
            cd: (args) => {
                if (args.length === 0 || args[0] === '~') {
                    state.linuxDir = '/home/user';
                } else if (args[0] === '..') {
                    const parts = state.linuxDir.split('/');
                    parts.pop();
                    if (parts.length === 0) {
                        state.linuxDir = '/';
                    } else {
                        state.linuxDir = parts.join('/');
                    }
                } else if (args[0].startsWith('/')) {
                    state.linuxDir = args[0];
                } else {
                    state.linuxDir = state.linuxDir + '/' + args[0];
                }
                
                // 更新提示
                const hostname = state.linuxDistro === 'centos' ? 'centos' : 
                               state.linuxDistro === 'debian' ? 'debian' : 'ubuntu';
                document.getElementById('linux-prompt').textContent = 
                    state.linuxDistro === 'centos' ? 
                    `[user@${hostname} ${state.linuxDir.replace('/home/user', '~')}]$` :
                    `user@${hostname}:${state.linuxDir.replace('/home/user', '~')}$`;
                
                addLinuxOutput(state.linuxDir, 'info');
            },
            
            uname: (args) => {
                const showAll = args.includes('-a');
                let info;
                
                switch(state.linuxDistro) {
                    case 'ubuntu': 
                        info = showAll ? 
                            'Linux ubuntu 5.15.0-86-generic #96-Ubuntu SMP Wed Sep 20 08:23:49 UTC 2023 x86_64 x86_64 x86_64 GNU/Linux' :
                            'Linux';
                        break;
                    case 'centos': 
                        info = showAll ?
                            'Linux centos 4.18.0-477.13.1.el8.x86_64 #1 SMP Wed Sep 20 08:23:49 UTC 2023 x86_64 x86_64 x86_64 GNU/Linux' :
                            'Linux';
                        break;
                    case 'debian': 
                        info = showAll ?
                            'Linux debian 5.10.0-23-amd64 #1 SMP Debian 5.10.179-1 (2023-05-12) x86_64 GNU/Linux' :
                            'Linux';
                        break;
                }
                addLinuxOutput(info, 'info');
            },
            
            whoami: () => {
                addLinuxOutput('user', 'info');
            },
            
            date: () => {
                const now = new Date();
                addLinuxOutput(now.toString(), 'info');
            },
            
            clear: () => {
                const terminal = document.getElementById('linux-terminal-output');
                const outputs = terminal.querySelectorAll('.terminal-output');
                outputs.forEach(output => {
                    if (!output.classList.contains('command-history')) {
                        output.remove();
                    }
                });
            },
            
            neofetch: () => {
                let logo;
                switch(state.linuxDistro) {
                    case 'ubuntu':
                        logo = `
            .-/+oossssoo+/-.               user@ubuntu
        \`:+ssssssssssssssssss+:\`           -------------
      -+ssssssssssssssssssyyssss+-         OS: Ubuntu 22.04.3 LTS x86_64
    .ossssssssssssssssssdMMMNysssso.       Host: Terminal Simulator
   /ssssssssssshdmmNNmmyNMMMMhssssss/      Kernel: 5.15.0-86-generic
  +sssssssssshmydMMMMMMMNddddyssssssss+     Uptime: 1 hour, 23 mins
 /sssssssshNMMMyhhyyyyhmNMMMNhssssss/      Packages: 2564 (dpkg), 8 (snap)
 .ssssssssdMMMNhsssssssssshNMMMdssssss.    Shell: bash 5.1.16
   -ossssssyyyysssssssssssssyyyyssssso-    Terminal: Terminal Simulator
     -+ssssssssssssssssssssssssssss+-      CPU: Intel i7-12700K (16) @ 3.60GHz
       \`:+ssssssssssssssssssssssss+:\`       Memory: 7894MiB / 15984MiB
           .-/+oossssoo+/-.`;
                        break;
                    case 'centos':
                        logo = `
                 .ohddddddddddddddddddddddddddho.         user@centos
              :yddddddddddddddddddddddddddddddddddy:      ------------
           .yddddddddddddddddddddddddddddddddddddddddy.   OS: CentOS Linux 8
         .yddddddddddddddddddddddddddddddddddddddddddddy. Kernel: 4.18.0-477.13.1.el8.x86_64
       .yddddddddddddddddddddddddddddddddddddddddddddddddy. Uptime: 1 hour, 23 mins
      yddddddddddddddddddddddddddddddddddddddddddddddddddddy Packages: 1456 (rpm)
    yddddddddddddddddddddddddddddddddddddddddddddddddddddddddy Shell: bash 4.4.20
   yddddddddddddddddddddddddddddddddddddddddddddddddddddddddddy CPU: Intel i7-12700K (16) @ 3.60GHz
  yddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddy Memory: 7894MiB / 15984MiB`;
                        break;
                    case 'debian':
                        logo = `
         _____         user@debian
      .-''     ''.     -----------
     /  _       _ \\    OS: Debian GNU/Linux 11 (bullseye)
    |  (_)     (_) |   Kernel: 5.10.0-23-amd64
     \\   .-------./    Uptime: 1 hour, 23 mins
      '-.|       |.-'   Packages: 2154 (dpkg)
        | |     | |     Shell: bash 5.1.4
        | |     | |     CPU: Intel i7-12700K (16) @ 3.60GHz
         '-.....-'      Memory: 7894MiB / 15984MiB`;
                        break;
                }
                addLinuxOutput(logo, 'info');
            },
            
            top: () => {
                addLinuxOutput('top - 14:30:00 up  1:23,  1 user,  load average: 0.08, 0.06, 0.05', 'info');
                addLinuxOutput('Tasks: 245 total,   1 running, 244 sleeping,   0 stopped,   0 zombie');
                addLinuxOutput('%Cpu(s):  5.7 us,  1.8 sy,  0.0 ni, 92.3 id,  0.2 wa,  0.0 hi,  0.0 si,  0.0 st');
                addLinuxOutput('MiB Mem :  15984.4 total,   7894.2 free,   4234.5 used,   3855.7 buff/cache');
                addLinuxOutput('MiB Swap:   2048.0 total,   2048.0 free,      0.0 used.  11234.2 avail Mem');
                addLinuxOutput('');
                addLinuxOutput('    PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND');
                addLinuxOutput('    840 user      20   0   12344   8924   4120 S   6.2   0.1   0:00.45 bash');
                addLinuxOutput('   1234 user      20   0  234568  45672  23456 S   2.3   0.3   1:23.45 Xorg');
                addLinuxOutput('   2345 user      20   0  567890  78901  34567 S   1.5   0.5   0:34.56 gnome-shell');
                addLinuxOutput('   3456 user      20   0  123456  23456  12345 S   0.7   0.2   0:12.34 python3');
                addLinuxOutput('   4567 user      20   0  345678  45678  23456 S   0.3   0.3   0:05.67 node');
            },
            
            ps: (args) => {
                const showAll = args.includes('aux');
                
                if (showAll) {
                    addLinuxOutput('USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND', 'info');
                    addLinuxOutput('root         1  0.0  0.1 169000 13004 ?        Ss   Oct15   0:03 /sbin/init');
                    addLinuxOutput('root         2  0.0  0.0      0     0 ?        S    Oct15   0:00 [kthreadd]');
                    addLinuxOutput('root         3  0.0  0.0      0     0 ?        I<   Oct15   0:00 [rcu_gp]');
                    addLinuxOutput('user      1234  0.5  2.5 234568 45672 tty2     Ssl+ Oct15   1:23 /usr/bin/Xorg');
                    addLinuxOutput('user      2345  0.3  3.0 567890 78901 tty2     Sl+  Oct15   0:34 /usr/bin/gnome-shell');
                    addLinuxOutput('user      3456  0.1  1.5 123456 23456 pts/0    S+   14:25   0:12 python3');
                } else {
                    addLinuxOutput('    PID TTY          TIME CMD', 'info');
                    addLinuxOutput('    840 pts/0    00:00:00 bash');
                    addLinuxOutput('   3456 pts/0    00:00:12 python3');
                    addLinuxOutput('   4567 pts/0    00:00:05 node');
                }
            },
            
            df: (args) => {
                const showHuman = args.includes('-h');
                
                if (showHuman) {
                    addLinuxOutput('Filesystem      Size  Used Avail Use% Mounted on', 'info');
                    addLinuxOutput('udev            7.8G     0  7.8G   0% /dev');
                    addLinuxOutput('tmpfs           1.6G  1.7M  1.6G   1% /run');
                    addLinuxOutput('/dev/nvme0n1p2   94G   23G   66G  26% /');
                    addLinuxOutput('tmpfs           7.8G   83M  7.7G   2% /dev/shm');
                    addLinuxOutput('tmpfs           5.0M  4.0K  5.0M   1% /run/lock');
                    addLinuxOutput('tmpfs           7.8G     0  7.8G   0% /sys/fs/cgroup');
                } else {
                    addLinuxOutput('Filesystem     1K-blocks    Used Available Use% Mounted on', 'info');
                    addLinuxOutput('udev              8128000       0   8128000   0% /dev');
                    addLinuxOutput('tmpfs             1631340    1700   1629640   1% /run');
                    addLinuxOutput('/dev/nvme0n1p2  98566144 24125440  69438464  26% /');
                    addLinuxOutput('tmpfs             8156684   84608   8072076   2% /dev/shm');
                }
            },
            
            free: (args) => {
                const showHuman = args.includes('-h');
                
                if (showHuman) {
                    addLinuxOutput('              total        used        free      shared  buff/cache   available', 'info');
                    addLinuxOutput('Mem:           15Gi       4.1Gi       7.7Gi       386Mi       3.8Gi        10Gi');
                    addLinuxOutput('Swap:         2.0Gi          0B       2.0Gi');
                } else {
                    addLinuxOutput('              total        used        free      shared  buff/cache   available', 'info');
                    addLinuxOutput('Mem:        15984408     4234508     7894208      395616     3855692    11234200');
                    addLinuxOutput('Swap:       2097148           0     2097148');
                }
            },
            
            mkdir: (args) => {
                if (args.length === 0) {
                    addLinuxOutput('mkdir: 缺少操作數', 'error');
                    return;
                }
                
                const dirName = args[0];
                const newDir = state.linuxDir + '/' + dirName;
                
                if (!state.filesystem.linux[newDir]) {
                    state.filesystem.linux[newDir] = [];
                    state.filesystem.linux[state.linuxDir].push(dirName);
                    addLinuxOutput(`已建立目錄 '${dirName}'`, 'success');
                } else {
                    addLinuxOutput(`mkdir: 無法建立目錄 '${dirName}': 檔案已存在`, 'error');
                }
            },
            
            touch: (args) => {
                if (args.length === 0) {
                    addLinuxOutput('touch: 缺少檔案操作數', 'error');
                    return;
                }
                
                const fileName = args[0];
                state.filesystem.linux[state.linuxDir].push(fileName);
                addLinuxOutput(`已建立檔案 '${fileName}'`, 'success');
            },
            
            cat: (args) => {
                if (args.length === 0) {
                    addLinuxOutput('cat: 缺少檔案操作數', 'error');
                    return;
                }
                
                const fileName = args[0];
                if (state.filesystem.linux[state.linuxDir].includes(fileName)) {
                    addLinuxOutput(`這是檔案 ${fileName} 的內容。`, 'info');
                    addLinuxOutput(`檔案建立時間: ${new Date().toLocaleString()}`);
                    addLinuxOutput(`檔案大小: 1024 位元組`);
                    addLinuxOutput(`檔案類型: 文字檔案`);
                } else {
                    addLinuxOutput(`cat: ${fileName}: 沒有此一檔案或目錄`, 'error');
                }
            }
        };
    </script>
</body>
</html>